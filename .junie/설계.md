- **완료**
    - **DeliveryCompany 택배사**
        - COLUMN
            - code
            - title
    - **City 시도**
    - **County 시군구**
    - **Banner 배너**
        - type
            - MAIN 메인
            - FARM_STORY 농가이야기
            - SUBSCRIBE 정기구독
            - DYNAMIC 직거래장터
        - title 제목
        - subtitle  nullable 부제목
        - url
        - button 버튼명
        - color_text 글자색상
        - color_button
        - started_at 노출시작일자
        - finished_at 노출종료일자
            - attribute
                - pc
                - mobile
            - testcase
                - 사용자
                    - 진행중인_목록을_조회할_수_있다

                        ```jsx
                        노출일자로 확인
                        ```

                    - 타입별_목록을_조회할_수_있다
                - 관리자
    - **Pop 팝업배너**
        - title 제목
        - url
        - open 노출여부
        - started_at 노출 시작일
        - finished_at 노출 종료일
            - attributes
                - img
            - testcase
                - 누구나_목록을_조회할_수_있다
                - 진행중인_목록만_조회할_수_있다

                    ```jsx
                    open이고 started_at과 finished_at 기간이 맞아야함
                    ```

    - **Factory 농가**
        - city_id 시/도
        - county_id 시/군/구
        - title 제목
            - testcase
                - 사용자


                - 관리자
                    - 기본 CRUD
                    - 시군구별_목록을_조회할_수_있다
    - **FarmStory 농가이야기**
        - user_id (관리자 id)
        - factory_id 농가
        - title 제목
        - description 내용
        - count_view default 0 조회수
            - attributes
                - img
                - factory
                - tags
                - user
                - count_like
                - is_like 좋아요여부
            - testcase
                - 사용자
                    - 누구나_목록을_조회할_수_있다
                    - 검색어로_목록을_조회할_수_있다
                        
                        ```jsx
                        word
                        ```
                        
                    - 좋아요순으로_목록을_조회할_수_있다
                    - 등록순으로_목록을_조회할_수_있다
                        
                        ```jsx
                        order_by
                        	count_like
                        	created_at
                        ```
                        
                    - 태그들을_포함한_목록을_조회할_수_있다
                        
                        ```jsx
                        tags
                        ```
                        
                    - 농가별_목록을_조회할_수_있다
                    - 특정_농가를_제외한_목록을_조회할_수_있다
                        
                        ```jsx
                        exclude_factory_id
                        ```
                        
                    - 좋아요를_할_수_있다 (좋아요 한번 더 하면 토글)
                        
                        ```jsx
                        likeable_type - Story
                        likeable_id
                        ```
                        
                    - 데이터를_조회할_수_있다
                    - 데이터를_조회하면_조회수가_갱신된다
                    - 데이터에서_좋아요여부를_조회할_수_있다
    - **FarmStory_Tag**
        - story_id
        - tag_id
    - **Tag 태그**
        - type 유형
            - FARM_STORY 농가이야기
            - RECIPE 레시피
            - VEGETABLE_STORY 채소이야기
            - PRODUCT 직거래장터
            - PACKAGE 꾸러미
        - title 태그명
        - color nullable 태그색상
        - open default 1 노출여부
        - order
            - attributes
            - testcase
                - 사용자
                    - 누구나_목록을_조회할_수_있다
                        - 순서순, 오픈여부 참
                    - 유형별_목록을_조회할_수_있다
                - 관리자
                    - 목록을_조회할_수_있다
                    - 검색어로_목록을_조회할_수_있다
                        - 제목, 색상코드
                    - 타입별_목록을_조회할_수_있다
                    - 타입별_개수를_조회할_수_있다
                        - counts
                    - 생성할_수_있다
                        
                        ```jsx
                        type
                        title
                        color
                        open
                        ```
                        
                    - 수정할_수_있다
                    - 순서를_수정할_수_있다
                    - 특정목록의_노출여부를_수정할_수_있다
                        
                        ```jsx
                        ids
                        open
                        ```
                        
                    - 특정_목록을_삭제할_수_있다
                        
                        ```jsx
                        ids
                        ```
                        
                    - 
    - **Material 품목**
        - type
            - PRODUCT 단일상품
            - PACKAGE 구독상품
        - category_id
        - title
        - descriptions nullable (품목내용을 여러개로 배열 저장 가능해야함)
            - attributes
                - img
                - format_descriptions
    - **Option 옵션**
        - type 유형
            - REQUIRED 필수
            - ADDITIONAL 추가
        - state 상태
            - ONGOING
            - EMPTY
            - HIDE
        - title 제목
        - price 가격
        - count 재고
    - **Product_Tag**
        - product_id
        - tag_id
    - **DeliverySetting 배송기본설정**
        - **delivery_company_id 택배사**
        - type_delivery 배송 유형
            - FREE 무료배송
            - EACH 개별배송
        - **[삭제] delivery_company 택배사**
            - **CJ CJ대한통운**
        - type_delivery_price 배송비 유형
            - STATIC 고정배송비
            - CONDITIONAL 조건부 무료배송
            - PRICE_BY_COUNT 수량별 차등 배송비
        - price_delivery 0 배송비
        - prices_delivery text 수량별 차등 배송비 (json 배열로 저장)
            - price
            - count
        - min_price_for_free_delivery_price 0 무료배송 최소주문금액
        - can_delivery_far_place default 1 제주도서산간 배송가능여부
        - ranges_far_place 제주/도서산간 지역 설정
    - **Like 좋아요**
        - user_id
        - likeable_id
        - likeable_type
            - testcase
                - 레시피에_대한_데이터를_생성할_수_있다 (toggle)
    - **Bookmark 북마크**
        - user_id
        - bookmarkable_id
        - bookmarkable_type
            - testcase
                - 레시피에_대한_데이터를_생성할_수_있다 (toggle)
    - **Product 상품 SoftDelete**
        - state
            - ONGOING 판매중
            - HIDE 숨김
            - EMPTY 품절
        - delivery_company_id 택배사
        - refund_delivery_company_id 반품택배사
        - category_id 분류
        - farm_id 농가
        - city_id 시도
        - county_id 시군구
        - uuid 상품번호 (자동생성필요)
            - 16자리
        - title 제목
        - price 판매가
        - price_origin 정가
        - need_tax boolean 과세여부
        - can_use_coupon 쿠폰사용 가능여부
        - can_use_point 적립금사용 가능여부
        - type_delivery 배송 유형
            - FREE 무료배송
            - EACH 개별배송
        - delivery_company 택배사
            - CJ CJ대한통운
        - type_delivery_price 배송비 유형
            - STATIC 고정배송비
            - CONDITIONAL 조건부 무료배송
            - PRICE_BY_COUNT 수량별 차등 배송비
        - price_delivery 0 배송비
        - prices_delivery text 수량별 차등 배송비 (json 배열로 저장)
            - price
            - count
        - min_price_for_free_delivery_price 0 무료배송 최소주문금액
        - can_delivery_far_place default 1 제주도서산간 배송가능여부
        - ranges_far_place 제주/도서산간 지역 설정
        - delivery_company_refund 반품택배사
            - CJ CJ대한통운
        - delivery_price_refund 반품 배송비
        - delivery_address_refund 교환/반품 배송지
        - description 상품상세
        - 
            - attributes
                - img 대표이미지
                - imgs
                - count_option 옵션수
                - requiredOptions 필수옵션
                    - state가 ONGOING인것만
                - additionalOptions 추가옵션
                    - state가 ONGOING인것만
                - ratio_discount 할인률
                - average_review 리뷰 평균
                - count_review 리뷰수
                - empty 품절여부
            - testcase
                - 사용자
                    - 누구나_진행중인_목록을_조회할_수_있다
                    - 검색어로_목록을_조회할_수_있다
                    - 태그들을_포함하는_목록을_조회할_수_있다
                    - 생성순으로_목록을_조회할_수_있다
                    - 리뷰수순으로_목록을_조회할_수_있다
                    - 주문수순으로_목록을_조회할_수_있다
                    - 데이터에서_품절여부를_조회할_수_있다
                - 관리자
                    - 목록을_조회할_수_있다
                    - 분류별_목록을_조회할_수_있다
                    - 키워드로_목록을_조회할_수_있다
                        - 상품명, 상품번호, 농가명
                    - 데이터에서_옵션수를_조회할_수_있다
                    - 생성할_수_있다
                        
                        ```jsx
                        category_id
                        imgs
                        title
                        factory_id
                        tag_ids
                        price
                        price_origin
                        need_tax
                        can_use_coupon
                        can_use_point
                        count
                        requiredOptions
                        	title
                        	price
                        	count
                        	state
                        remove_ids_required_options
                        additionalProducts
                        	title
                        	price
                        	count
                        	state
                        remove_ids_additional_products
                        type_delivery
                        delivery_company
                        type_delivery_price
                        delivery_price
                        min_price_for_free_delivery_price
                        delivery_prices 수량별 차등 배송비
                        can_delivery_far_place
                        delivery_price_far_place
                        delivery_company_refund
                        delivery_price_refund
                        delivery_address_refund
                        description
                        state
                        ```
                        
    - **Project 소농살리기 프로젝트**
        - product_id
        - started_at datetime 시작일자
        - finished_at datetime 종료일자
        - count_goal 목표인원
        - count_participate 참여인원
            - attributes
                - tags
                - product
                - img
                - state 진행상태
                    - BEFORE
                    - ONGOING
                    - FINISH
                - format_state 표시용 진행상태
                - ratio_progress 진행률
                - days_remain 남은일자
                - time_remain 남은시간 (00:00:00 시분초 형태)
            - testcase
                - 누구나_진행중인_목록을_조회할_수_있다
                - 데이터에서_남은일자를_조회할_수_있다
                - 데이터에서_남은시간을_조회할_수_있다
                - 데이터에서_진행률을_조회할_수_있다
    - **CouponGroup_User**
        - coupon_group_id
        - user_id
    - **CouponGroup_Product**
        - coupon_group_id
        - product_id
    - **Cart 장바구니**
        - user_id
        - 
            - testcase
                - 누구나_자신의_장바구니에_담은_상품조합_목록을_조회할_수_있다
                - 누구나_장바구니에_상품조합을_담을_수_있다
                    - preset_id (preset이 누구건지 확인 필요)
                - 누구나_자신의_장바구니의_상품조합목록을_삭제할_수_있다
    - **Delivery 배송지**
        - main default 0 기본배송지여부
        - user_id
        - title 배송지명
        - name 받으시는분
        - contact 연락처
        - address
        - address_detail
        - address_zipcode
            - testcase
                - 사용자는_자신의_목록을_조회할_수_있다
                - 데이터를_생성할_수_있다
                - 데이터를_기본배송지로_설정할_수_있다
                - 기본배송지가_설정되면_다른_배송지는_기본배송지가_아니게된다
    - **Review 리뷰**
        - user_id
        - package_id nullable
        - product_id nullable
        - preset_product_id nullable
        - best default 0 베스트 여부
        - score 점수
        - description 내용
        - reply nullable 관리자 답글
        - reply_at nullable 관리자 답글일자
        - point default 0 받은 포인트
        - hide default 0 관리자 가림여부
        - 
            - attributes
                - img 대표이미지
                - imgs
                - format_display 표시용 상품제목 태그 (꾸러미 3회차, 귤 1박스)
                - is_like
                - is_bookmark
            - testcase
                - 누구나_목록을_조회할_수_있다
                - 상품별_목록을_조회할_수_있다
                - 패키지별_목록을_조회할_수_있다
                - 상품유형별_목록을_조회할_수_있다
                    
                    ```jsx
                    has_column
                    ```
                    
                - 좋아요순으로_목록을_조회할_수_있다
                - 등록순으로_목록을_조회할_수_있다
                - 사용자는_데이터를_생성할_수_있다
                - 사용자는_자신의_구매확정건에_대해서만_데이터를_생성할_수_있다
                - 같은_주문건에_대해_중복생성할_수_없다
                - 생성시_포토리뷰_일반리뷰냐에_따라_적립금이_차등지급된다
                - 베스트리뷰로_선정될_시_추가적립금이_지급된다
    - **Count 통계**
        - sum_weight default 2226227 누적 농산물
        - sum_store  default 10023 함께한 농가수
            - attributes
                - **count_review 전체 후기수**
                - **count_review_package 패키지 이용후기수**
                - **average_score_review_package 패키지 평균만족도**
                - **count_vegetable_story 채소이야기**
            - testcase
                - 누구나_목록을_조회할_수_있다
    - **Package_Recipe**
        - package_id
        - recipe_id
    - **VegetableStory 채소이야기**
        - user_id
        - package_id nullable
        - product_id nullable
        - preset_product_id nullable
        - recipe_id nullable
        - description nullable
            - attributes
                - img
                - imgs
                - tags
                - format_display 표시용
                - count_like 좋아요수
                - count_bookmark 북마크수
                - count_comment 댓글수
                - recipe(MiniReousrce 사용)
                - format_created_at Y.m.d
                - is_like
                - is_bookmark
            - testcase
                - 누구나_목록을_조회할_수_있다
                - 사용자별_목록을_조회할_수_있다
                - 특정_태그들을_포함하는_목록을_조회할_수_있다
                - 키워드를_포함하는_목록을_조회할_수_있다
                - 상품별_목록을_조회할_수_있다
                - 패키지별_목록을_조회할_수_있다
                - 상품유형별_목록을_조회할_수_있다
                    
                    ```jsx
                    type_product
                    ```
                    
                - 좋아요순으로_목록을_조회할_수_있다
                - 등록순으로_목록을_조회할_수_있다
                - 사용자는_데이터를_생성할_수_있다
                    
                    ```jsx
                    imgs: []
                    preset_product_id (nullable)
                    description
                    recipe_id nullable
                    tag_ids
                    
                    preset_product_id를 통해 package_id나 product_id가 자동설정되어야함
                    
                    ```
                    
                - 관련출고건이_있다면_자신의_출고건이고_구매확정된_출고건이어야만_데이터를_생성할_수_있다
                - 데이터를_생성할때_특정_출고건에_대한_데이터라면_적립금이_부여된다
                    
                    ```jsx
                    1회 80원
                    2회 100원
                    3회 120원
                    적립할때마다 pointHistory 쌓여야함
                    ```
                    
                - 자신의_데이터를_수정할_수_있다
                    - preset_product_id는 수정불가주의
                - 자신의_데이터를_삭제할_수_있다
    - **Tag_VegetableStory**
        - tag_id
        - vergetable_story_id
    - **Recipe 레시피**
        - user_id
        - title
        - description
        - materials text 필수재료 (json 배열)
        - seasonings text 양념 (json 배열)
        - ways 레시피순서
            - attributes
                - user
                - img (imgs의 첫번째)
                - imgs
                - tags
                - format_materials
                - format_recipes
                - format_seasonings
                - count_like
                - count_bookmark
                - is_like 좋아요 여부
                - is_bookmark 북마크 여부
            - testcase
                - 사용자
                    - 누구나_목록을_조회할_수_있다
                    - 검색어로_목록을_조회할_수_있다
                    - 태그들을_포함하는_목록을_조회할_수_있다
                    - 좋아요순으로_목록을_조회할_수_있다
                    - 등록순으로_목록을_조회할_수_있다
                    - 좋아요여부를_조회할_수_있다
                    - 북마크여부를_조회할_수_있다
                    - 꾸러미별_목록을_조회할_수_있다
                    - 상세를_조회할_수_있다
    - **Recipe_Tag**
        - recipe_id
        - tag_id
    - **Comment**
        - user_id
        - commentable_id
        - commentable_type
            - App\Models\VegetableStory
        - description
            - attributes
                - count_like 좋아요수
                - format_created_at (Y.m.d)
            - testcase
                - 누구나_목록을_조회할_수_있다
                - 특정_대상에_대한_목록을_조회할_수_있다
                - 좋아여순으로_목록을_조회할_수_있다
                - 등록순으로_목록을_조회할_수_있다
                - 사용자는_데이터를_생성할_수_잇다
                    
                    ```jsx
                    commentable_id
                    commentable_type
                    description
                    ```
                    
                - 사용자는_자신의_데이터를_수정할_수_있다
                - 사용자는_자신의_데이터를_삭제할_수_있다
    - **ReportCategory 신고유형**
        - title
            - seeder
                
                ```jsx
                관련없는 이미지/내용
                욕설/비방
                광고/홍보글
                도배 및 중복
                기타
                ```
                
            - testcase
                - 누구나_목록을_조회할_수_있다
    - **Report 신고하기**
        - user_id
        - report_category_id
        - reportable_type
        - reportable_id
        - description nullable 내용
        - check defualt 0 확인여부
            - testcase
                - 사용자는_데이터를_생성할_수_있다
                    
                    ```jsx
                    report_category_id
                    reportable_id
                    reportable_type (App\Models\Comment, App\Models\VegetableStory | App\Models\Review)
                    description
                    ```
                    
                - 같은_대상에_대한_데이터를_중복생성할_수_없다
    - **PackageSetting_Material**
        - package_setting_id
        - material_id
        - unlike default 0 비선호 여부
    - **CouponGroup 쿠폰 (SoftDelete지만 삭제 시에 하위쿠폰 삭제?)**
        - title
        - moment nullable
            - UPDATE_PROFILE 프로필 업데이트
                - 최초로 생년월일, 가구수 입력하면 1000원 지급
            - GRADE 등급혜택
                - 등급 갱신일 확인해서 그때마다 쿠폰 발급해야할듯
                - 등급갱신 스케줄 짤 때 거기다 쿠폰발급도 넣어야할듯
            - BIRTHDAY 생일쿠폰
                - 생일 때 한번 주는건데 생일 바꿔가면서 여러번 못타먹게 해달라함
            - FIRST_ORDER 첫구매
        - type
            - ALL 모든상품
            - PACKAGE 구독패키지
            - PRODUCT 직거래상품
            - DELIVERY 배송비
        - type_package nullable 꾸러미 쿠폰적용 유형
            - SINGLE 싱글
            - BUNGLE 벙글
        - all_product nullable 모든 직거래상품 적용가능여부
        - target
            - ALL 전체회원
            - GRADE 고객등급
            - ORDER_HISTORY 구매이력
            - PERSONAL 개인회원
        - grade_id nullable 대상 고객등급
            - nullable
        - min_order nullable 최소 구매이력수 (최근 3개월 n회 구매한 사람에게만 적용하는 쿠폰)
        - type_discount 할인유형
            - NUMBER 원
            - RATIO %
        - value 할인값
        - max_price_discount 최대할인값
        - min_price_order 최소주문금액 (할인가기준)
        - type_expire 유효기간 유형
            - SPECIFIC 날짜지정
            - FROM_DOWNLOAD 다운로드일 기준
        - started_at datetime nullable 시작일
        - finished_at datetime nullable 종료일
        - days nullable 유효기간 (다운로드일 기준)
            - attributes
                - has 보유여부
                    - 보유하고 있어도 사용했는지도 체크해야함 (BEFORE_PAYMENT 이상의 preset을 갖고 있으면 쓴거임)
            - testcase
                - 누구나_목록을_조회할_수_있다
                    
                    ```jsx
                    moment가 null
                    type_expire가 from_download거나 specific이면 유효기간이 유효한 경우
                    ```
                    
                - 다운_가능한_목록을_조회할_수_있다
                - 할인값순으로_목록을_조회할_수_있다
                - 등록순으로_목록을_조회할_수_있다
            - seeder
                
                ```jsx
                
                $items = [
                	[
                		'title' => '개인정보입력 할인 쿠폰',
                		'moment' => MomentCouponGroup::PROFILE,
                		'type' => TypeCouponGroup::ALL,
                		'target' => TargetCouponGroup::ALL,
                		'type_discount' => TypeDiscountCouponGroup::NUMBER,
                		'value' => 1000,
                		'max_price_discount' => 1000,
                		'min_price_order' => 1000,
                		'type_expire' => TypeExpire::FROM_DOWNLOAD,
                		'days' => 60,
                	],
                	[ // 등급별로 각 등급 혜택금액에 맞게 넣어야함
                		'title' => '등급쿠폰',
                		'moment' => MomentCouponGroup::GRADE,
                		'grade_id' => '',
                		'type' => TypeCouponGroup::ALL,
                		'target' => TargetCouponGroup::ALL,
                		'type_discount' => TypeDiscountCouponGroup::NUMBER,
                		'value' => ,
                		'max_price_discount' => ,
                		'min_price_order' => ,
                		'type_expire' => TypeExpire::FROM_DOWNLOAD,
                		'days' => 60,
                	],
                	[
                		'title' => '생일쿠폰',
                		'moment' => MomentCouponGroup::BIRTHDAY,
                		'type' => TypeCouponGroup::ALL,
                		'target' => TargetCouponGroup::ALL,
                		'type_discount' => TypeDiscountCouponGroup::NUMBER,
                		'value' => 3000,
                		'max_price_discount' => 3000,
                		'min_price_order' => 3000,
                		'type_expire' => TypeExpire::FROM_DOWNLOAD,
                		'days' => 60,
                	],
                	[
                		'title' => '첫구매',
                		'type' => TypeCouponGroup::ALL,
                		'target' => TargetCouponGroup::ALL,
                		'type_discount' => TypeDiscountCouponGroup::NUMBER,
                		'value' => 3000,
                		'max_price_discount' => 3000,
                		'min_price_order' => 3000,
                		'type_expire' => TypeExpire::FROM_DOWNLOAD,
                		'days' => 60,
                	],
                ];
                ```
                
    - **Coupon 쿠폰 (SoftDelete)**
        - user_id
        - coupon_group_id
        - use 0
            - testcase
                - 사용자
                    - 쿠폰그룹고유번호들로_쿠폰을_생성할_수_있다
                    - 권한이_없는_쿠폰은_생성할_수_없다
                        
                        ```jsx
                        # 불가
                        - moment가 있는 경우
                        - 이미 보유
                        - 대상이 아닌 경우 (이거 어떻게 하냐, 일단 패스?)
                        ```
                        
                    - 자신의_목록을_조회할_수_있다
                        - **use 0인지 체크 필요**
                    - 특정_상품에_사용할_수_있는_목록을_조회할_수_있다
                    - 할인값순으로_목록을_조회할_수_있다
                    - 생성일자순으로_목록을_조회할_수_있다
    - **FaqCategory 자주묻는질문 카테고리**
        - title
            - seeder
                
                ```jsx
                배송
                교환/반품/취소
                서비스
                주문/결제
                회원정보
                ```
                
            - testcase
                - 누구나_목록을_조회할_수_있다
    - **Faq 자주묻는질문**
        - faq_category_id
        - title
        - description
            - testcase
                - 누구나_목록을_조회할_수_있다
    - **QnaCategory 1대1문의 카테고리**
        - title
            - seeder
                
                ```
                배송
                교환/반품/취소
                서비스
                주문/결제
                상품확인
                회원정보
                기타
                ```
                
            - testcase
                - 누구나_목록을_조회할_수_있다
    - **Qna 1대1문의**
        - user_id
        - qna_category_id
        - description
        - answer nullable
        - answered_at nullable
            - attributes
                - imgs
    - **Category 상품분류**
        - type
            - PRODUCT 직거래장터
            - PACKAGE 꾸러미
        - category_id nullable
        - title
            - attributes
                - materials
            - testcase
                - 누구나_목록을_조회할_수_있다
                    - 1차 카테고리만 내보내고 1차카테고리에 hasManyThough 통해서 materials를 가져와
                - 유형별_목록을_조회할_수_있다
    - **Grade 등급**
        - title
        - ratio_refund 할인 적립률
        - min_price 등급달성을 위해 필요한 최소금액
        - min_count_package 패키지 최소횟수
        - level 레벨
            - testcase
                - 다음_등급_레벨업을_위해_남은_금액과_회차를_알_수_있다
    - **User 사용자**
        - always_use_coupon_for_package default 0 꾸러미 결제 시 쿠폰 자동 적용여부
        - always_use_point_for_package default 0 꾸러미 결제 시 적립금 자동사용여부
        - message nullable 프로필 메시지
        - nickname nullable 닉네임
        - delivery_requirement nullable 배송요청사항
        - grade_id
        - social_id
        - social_platform
        - email unique 이메일 아이디
        - password
        - name 이름
        - contact unique 연락처
        - agree_promotion 혜택수신동의
        - code_recommend nullable 추천인 코드
        - count_family nullable 가구원수
        - birth nullable 생년월일
            - attributes
                - point_use 총 사용 적립금
                - **point 남은 포인트**
                - **packageSetting 패키지 세팅 (null 주의)**
                - **count_cart**
                - count_ongoing_preset_product 주문배송수
                - count_coupon 보유쿠폰수
            - **testcase**
                - 누구나_생성을_할_수_있다
                - 인증된_전화번호로만_생성을_할_수_있다
                - 사용자는_추천인코드를_업데이트할_수_있다
                    
                    ```jsx
                    code
                    ```
                    
                - 존재하지_않는_추천인코드는_업데이트할_수_없다
                - 이미_추천인코드가_있다면_업데이트할_수_없다
                - **추천인코드가_업데이트되면_추천자와_추천받은자에게_적립금이_지급된다**
                    - **포인트내역 쌓여야함 (2000p 부여)**
                - **데이터에서_남은_포인트를_조회할_수_있다**
                - **데이터에서_누적사용포인트를_조회할_수_있다**
                - 누구나_비밀번호를_초기화할_수_있다
                    
                    ```jsx
                    email
                    contact (인증전화번호)
                    password
                    password_confirmation
                    ```
                    
                - 사용자는_비밀번호를_수정할_수_있다
                    
                    ```jsx
                    password 기존 비밀번호
                    password_new
                    password_new_confirmation
                    ```
                    
                - 누구나_아이디를_찾을_수_있다
                    
                    ```jsx
                    contact (인증전화번호)
                    ```
                    
                - 사용자가_탈퇴를_하면_구독은_취소된다
                    - package_setting active 되어있었으면 0처리 및 결제준비중인 꾸러미출고 삭제
                - 사용자는_정보를_수정할_수_있다
                    
                    ```
                    password nullable
                    password_confirmation nullable
                    name
                    contact nullable (값이 있다면 인증된 번호여야함)
                    nikcname nullable
                    message
                    birth
                    count_family
                    agree_promotion
                    ```
                    
                - 
    - **Points 포인트**
        - user_id
        - point default 0
        - expired_at 생성일로부터 1년뒤
            - testcase
                - 유효기간만료처리를_실행하면_유효기간이_만료된_포인트들은_회수되고_포인트내역이_생성된다
    - **PointHistory 포인트내역**
        - point_id
        - type
            - USER_RECOMMENDED 추천받음
            - USER_RECOMMEND 추천함
            - ORDER_CREATED 주문
            - PRESET_PRODUCT_CANCLED 주문취소
            - PHOTO_REVIEW_CREATED 포토리뷰 작성
            - TEXT_REVIEW_CREATED 일반리뷰 작성
            - BEST_REVIEW_UPDATED 베스트리뷰 선정
            - VEGETABLE_STORY_CREATED 채소이야기 작성
            - PRESET_PRODUCT_CONFIRM 구매확정
            - EXPIRED 유효기간만료
        - point default 0 포인트
        - point_leave default 0 남은포인트
        - point_historiable_id
        - point_historiable_type
            - attribute
                - format_title
            - testcase
                - 나의_목록을_조회할_수_있다
    - **PackageSetting 패키지 설정**
        - type_package 패지키 유형 (싱글, 벙글)
        - term_week 주기(몇주에 한번)
        - name nullable
        - user_id
        - card_id 간편결제 카드정보
        - delivery_id
        - actvie default 1 구독활성여부
        - 
            - attributes
                - format_unlike_materials 비선호 품목 (당근, 콜라비, 브로콜리, 비트잎)
                    - materials 중 pivot unlike가 1인 애들
            - testcase
                - 사용자는_패키지설정을_생성할_수_있다
                    
                    ```
                    type_package
                    term
                    delivery_id
                    card_id
                    unlike_merterial_ids (최대 7개만 등록 가능)
                    active 활성여부 (일회성 구매일 때)
                    ```
                    
                - 
                - **패키지설정이_생성되면_현재이용가능회차를_대상으로_출고가_생성된다**
                    - 출고에 pacakge_setting_active도 기록 필요 (1회성인지 아닌지 구분용)
                - **패키지설정의_활성여부가_참으로_수정됐을때_진행중인_출고가_없으면_출고가_새로_생성된다**
                    - 대기중이거나_진행중인_꾸러미출고가_없다면_생성
                - 
                - 패키지설정이_생성되면_꾸러미이름이_자동생성된다
                    
                    ```jsx
                    닉네임의 꾸러미
                    ```
                    
                - 꾸러미유형을_수정할_수_있다
                    
                    ```jsx
                    메소드를 각각 만들지말고 있는값만 수정하는식으로 수정
                    ```
                    
                - 배송주기를_수정할_수_있다
                - 비선호품목을_수정할_수_있다
                - 배송지를_수정할_수_있다
                - 결제카드를_수정할_수_있다
                - 꾸러미이름을_수정할_수_있다
                - **정기구독을_정지할_수_있다**
                    - **active를 0으로 설정 및 중지기록 남기기**
                    - **결제대기중인 presetProduct 삭제**
    - **StopHistory 정기구독 중단기록**
        - user_id
        - remove_preset_product_id nullable 중단으로 인해 삭제된 presetProduct가 있다면 입력
        - reason 사유
        - and_so_on 추가입력
    - **Package 꾸러미**
        - count 회차
        - tax default 0 과세여부
        - will_deliveried_at nullable 도착예정일
        - start_pack_wait_at nullable 구성대기 시작일
        - finish_pack_wait_at nullable 구성대기 종료일
        - start_pack_at  nullable 품목구성 시작일
        - finish_pack_at  nullable 품목구성 종료일
        - start_delivery_ready_at nullable 배송준비 시작일
        - finish_delivery_ready_at nullable 배송준비 종료일
        - start_will_out_at nullable 출고예정 시작일
        - finish_will_out_at nullable 출고예정 종료일
        - **alert_pack default 0 품목구성알림여부**
            - attributes
                - materials (pivot이 있으면 pivot 데이터도 보이게)
                - 날짜들 format처리
                - format_will_deliveried_at - 2024.12.12(금)
                - **state 상태**
                    - WAIT_PACK 구성대기
                    - ONGOING_PACK 품목구성
                    - DELIVERY_RADY 배송준비
                    - WILL_OUT 출고예정
                - **format_state 표시용 상태**
            - testcase
                - **꾸러미에서_상태를_조회할_수_있다**
                - **현재_진행중인_패키지를_조회할_수_있다**
                    - **구성대기시작일  ≤ 현재 ≤ 도착예정일 + 1일**
                - **현재_신청가능한_패키지를_조회할_수_있다**
                - **나의_현재_꾸러미출고를_조회할_수_있다 (마이페이지에 보여줄용)**
                    - **출고의 대상회차가 현재 진행중인 회차 리턴**
                    - **패키지설정의 구독여부가 꺼져있다면 (active 0) null을 리턴**
                    - **가장 최근 꾸러미 출고 리턴**
                - **품목구성알림을_실행하면_품목구성완료일이_지난_이번회차를_대상회차로_설정해놓은_패키지설정을_보유한_사용자들에게_알림이_발송된다**
                    
                    ```
                    # 알람조건
                    - 이번 회차여야함
                    - 현재시간이 품목구성완료일 이상이여야함
                    - 품목구성알림여부가 거짓이어야함
                    - 이번회차를 현재대상회차로 설정해놓은 패키지설정을 보유한 사용자들이어야함
                    
                    # 알람
                    - 알람 발송 후 품목구성알림여부 1로 업데이트
                    - 해당 출고에 싱글,벙글이냐에 따라 품목 자동 연결
                    ```
                    
                - 품목구성알림이_실행되면_출고에_품목이_자동으로_연결된다
                    
                    ```
                    비선호품목은 제외되고 제외된만큼 다른 품목 자동더하기 (반복문 돌려서 최소금액 채울때까지 랜덤으로 1개씩 추가하기)
                    ```
                    
                - **자동결제를_시도하면_현재_회차를_대상회차로_갖고있는_사용자들중_결제전인_출고에_대해_결제가_시도된다**
                - **결제가_성공사태가_되면_다음_출고가_자동생성된다**
                    - **PackageSetting이 active라면 배송주기에 맞게 다음 출고 생성**
                - **결제를_시도할_시_사용자의_쿠폰자동적용여부가_참이라면_쿠폰이_자동적용된다**
                    - **쿠폰유형이 꾸러미용이고 최소주문금액 맞출 경우 최대금액까지만 쓸 수 있게 쿠폰 찾아야할듯**
                - **결제를_시도할_시_사용자의_적립금자동적용여부가_참이라면_적립금이_자동적용된다**
                    - 결제금액이 1000원 남을때까지만 적용
                - **자동결제를_실패하면_3번까지_재시도한다**
                - **3번까지_재시도를_실패하면_다음_회차로_자동미루기가_된다**
                    - ***미루기 당기기 기록 생성 필요***
                    - **쌓인 실패 orders의 수를 보기 (reason도 남겨)**
                - **사용자는_출고의_품목구성을_수정할_수_있다**
                    
                    ```
                    materials
                    	id
                    	count
                    ```
                    
                - **출고의_대상회차에_있는_선택가능구성_및_기본구성_내에서만_수정할_수_있다**
                - **출고의_대상회차가_품목구성상태가_아니라면_수정할_수_없다**
                - **품목구성금액은_패키지유형의_최소금액을_맞춰야한다**
                - **출고에서_미루기_및_당기기_가능한_패키지를_조회할_수_있다**
                - **배송당기기를_할_수_있다**
                    
                    ```
                    - 출고가 결제대기중이어야함
                    - 해당 출고에 당기기 가능한 패키지가 있어야함
                    - 당길 경우 대상회차가 현재주문가능회차로 변경됨
                    - 배송당기기 히스토리가 생성됨
                    ```
                    
                - **배송미루기를_할_수_있다**
                    
                    ```
                    - 출고가 결제대기중이어야함
                    - 미룰 경우 대상회차가 현재회차의 바로 다음회차로 변경됨
                    - 배송미루기 히스토리가 생성됨
                    ```
                    
    - **Package_Material**
        - package_id
        - material_id
        - type
            - SINGLE 싱글
            - BUNGLE 벙글
            - CAN_SELECT 선택가능
        - count 수량
        - unit 단위
        - price_origin 정가
        - price 판매가
    - **Package_Material_Tag**
        - package_material_id
        - tag_id
    - **PackageChangeHistory 꾸러미 일정변경 이력**
        - user_id
        - preset_product_id
        - origin_package_id 원래 패키지
        - type
            - FAST 당기기
            - LATE 미루기
    - **Preset 상품조합**
        - order_id nullable
        - cart_id nullable
        - **package_id nullable**
        - user_id
        - price_delivery 0 배송비
        - price default 0 최종금액
        - price_total default 0 상품 총 금액
        - price_discount default 0 할인금액
        - count_option_required nullable 필수옵션 개수
        - count_option_additional nullable 추가옵션 개수
            - attributes
                - presetProducts
                - order
                - can_order
            - testcase
                - 직거래상품관련_데이터를_생성할_수_있다
                    
                    ```jsx
                    **type_product
                    
                    # 꾸러미라면
                    package_id
                    
                    # 직거래상품이라면**
                    [
                    	{
                    		product_id: "",
                    		option_id: "",
                    		count: "",
                    	}
                    ]
                    ```
                    
                - 꾸러미관련_데이터를_생성할_수_있다
                - 재고보다_더_많이_생성할_수_없다
                    - 반복문으로 옵션과 상품의 재고를 확인하고 forBidden으로 무슨 상품 재고가 털렸는지 뿌려주기
                - 데이터를_생성하면_비용이_갱신된다
                    
                    ```jsx
                    # calculate
                    - price 최총 금액
                    - price_total 상품 총 금액
                    - price_discount 할인금액
                    - price_delivery 배송비
                    - count_option_required
                    - count_option_additional
                    
                    # 배송비 계산
                    - type_delivery가 FREE라면
                    	- price_delivery = 0
                    - type_delivery가 EACH라면
                    	- type_delivery_price가 STATIC이라면
                    		- price_delivery = price_delivery
                    	- type_delivery가 CONDITIONAL이라면
                    		- min_price_for_free_delivery_price <= price? 
                    			- 참이라면 무료
                    			- 거짓이라면 price_delivery
                    	- type_delivery가 PRICE_BY_COUNT라면
                    		-  prices_delivery 배열을 순차조회하면서 상품조합의 필수옵션 선택한 상품의 개수가 n개 이상인 구간 찾기 (그 구간의 price가 배송비)
                    	-> 도서산간이면 delivery_price_far_place 추가해야함
                    		
                    # 쿠폰
                    최종가 기준으로 쿠폰 적용되어야함
                    ```
                    
                - 사용자는_자신의_데이터를_수정할_수_있다
                    
                    ```jsx
                    [
                    	{
                    		product_id: "",
                    		option_id: "",
                    		count: "",
                    	}
                    ]
                    ```
                    
                - 데이터를_수정하면_비용이_갱신된다
    - **Material_PresetProduct**
        - material_id
        - preset_product_id
        - price
        - price_origin
        - unit
        - count
- **Card [새로 설계해야됨, pg사 연동 필요]**
    - user_id
    - card_number
    - expiry
    - birth
    - password
    - name nullable 카드사명
    - billigKey 빌링키
        - testcase
            - 사용자는_자신의_목록을_조회할_수_있다
            - 사용자는_카드를_생성할_수_있다
            - 사용자는_카드를_삭제할_수_있다
- **Order (주문이랑 출고내역은 있는거 활용)**

    ```jsx
    # 주문 프로세스
    - 여러개 담아서 구매
    
    - 적립금 사용 시 구성상품들 비율에 맞게 presetProducts에 적립금 계산 적용 -> preset
    _product에 point 컬럼 추가 (단, n빵하면 비는 금액이 있으니까 마지막 금액은 남은 적립금 전부를 가지게)
    
    - 쿠폰 미사용처리하기
    
    - presetProduct별로 취소를 하는데 해당 preset의 다 취소하고 남은 마지막 presetProduct라면 배송비 차감하고 취소해주기
    
    - 결제대기, 배송준비 상태일때만 주문취소 가능
    
    - 그 이후 상태로는 반품,교환요청이 따로 없고 취소요청이 있음
    -> 취소요청 수락하면 개발로 취소처리되면 됨
    -> 현재 반품에 enum 대한 상태를 취소에 대한 상태로 변경해야함
    
    ```

    - imp_uid
    - merchant_uid

    - user_id nullable
    - user_name
    - user_email
    - user_contact

    - pay_method_id
    - pay_method_name
    - pay_method_pg
    - pay_method_method

    - vbank_num
    - vbank_name
    - vbank_date

  // 배송지 정보 (다 nullable)

    - delivery_name 수취인명
    - delivery_contact 연락처
    - delivery_address
    - delivery_address_detail
    - delivery_address_zipcode
    - delivery_requirement nullable 배송요청사항
    - type_delivery 택배 방법
        - DELIVERY 택배
        - QUICK 퀵서비스
        - DIRECT 직접방문

    - point_use default 0 사용한 마일리지

    - agree_open default false 주문제품 시안파일 등의 정보노출 동의여부

    - price
    - state
        - BEFORE_PAYMENT 결제준비
        - WAIT 결제대기
        - SUCCESS 결제성공
        - CANCEL 결제취소
    - memo
    - reason
    - process_success default false 결제완료처리여부
        - SEEDER
            - orders 상태별
                - presetProducts 상태별
                    - 꾸러미, 직거래상품
        - ATTRIBUTES
            - format_state
            - presets 주문상품정보목록 (출고목록)
            - can_cancel 취소가능여부
            - format_created_at
            - format_type_delivery
        - TESTCASE
            - 데이터를_생성할_수_있다

                ```jsx
                **type_product: 상품유형 (직거래, 꾸러미)**
                
                merchant_uid 생성해야함
                
                preset_ids: [],
                
                # 공통
                // 배송지 정보 (다 nullable)
                delivery_name 수취인명
                delivery_contact 연락처
                delivery_address
                delivery_address_detail
                delivery_address_zipcode
                delivery_requirement nullable 배송요청사항
                
                point_use default 0 사용한 마일리지
                ```

            - 도서산간불가상품이_포함될_경우_도서산간인_지역에_대하여_생성할_수_없다
            - 사용할_포인트는_보유한_포인트만큼이_최대값이다

            - 주문구성에_맞게_결제금액이_계산된다
                - 마일리지
                - 쿠폰 (쿠폰은 최종결제가가 아니라 종합상품금액 기준으로 할인 들어가야함)
                - 상품수 * 상품가격
                - 추가상품수 * 추가상품가격
            - 주문이_생성되면_세트상품이_연결된다
            - **[NEW] 주문이_결제대기_또는_성공상태가_되면_쿠폰은_사용처리된다**
                - **use를 1로 처리**
                - **presetProduct나 package에 coupon_id 등록**
                - **쿠폰사용기록이 생성되어야함**
            - **주문이_결제대기_또는_성공상태가_되면_사용자에게서_포인트를_차감한다**
                - **point가 0 초과일 때만 해당 작업**
                - **포인트 사용기록 생성되어야함**
            - **주문이_결제대기_또는_성공상태가_되면_출고상품가격비율에_맞게_포인트가_배분된다**
            - 주문이_결제대기_또는_성공상태가_되면_재고수가_줄어든다
            - **포인트는_오래된순부터_사용처리된다**
            - 주문이_결제대기_또는_성공상태가_되면_장바구니에서_삭제된다
            - 주문이_성공상태가_되면_상품세트는_상품준비중_상태가_된다
            - 주문이_성공상태가_되면_관련상품의_주문수가_갱신된다
            - 자신의_결제준비상태를_제외한_목록을_조회할_수_있다
            - 데이터에서_상품세트목록을_조회할_수_있다

            - 자신의_데이터를_조회할_수_있다
            - 결제성공상태가_되면_관련상품들의_데이터가_갱신된다
                - delivery_name nullable 받는분 이름
                - delivery_contact nullable 받는분 연락처
                - delivery_address nullable 받는분 주소
                - delivery_address_detail nullable 받는분 주소상세
                - delivery_address_zipcode nullable 받는분 우편번호
                - delivery_message nullable 받는분 배송메세지

              // 결제완료처리할 때 업데이트할 출고 내용

                - title nullable 결제당시 상품제목
                - price nullable 결제당시 최종판매가
                - price_discount nullable 결제당시 할인가
                - price_origin nullable 결제당시 본래판매가
                - price_delivery nullable 결제당시 택배비
            - **꾸러미_상품이라면_현재_회차의_꾸러미만_구매할_수_있다**
            - **[NEW] 유형별_목록을_조회할_수_있다**

                ```
                has_column product_id, package_id
                ```

            - **[NEW] 상태별_목록을_조회할_수_있다**

                ```
                states (주문내역, 환불 및 취소내역)
                ```

            - **[NEW] 적립금을_사용하면_가장_최근_적립금내역부터_사용처리된다**

                ```
                적립금 내역마다 유효기간이 있어서 일정시간 지나면 소멸시켜야함
                ```

            - **제주도서산간불가_상품이_포함되어있고_배송지가_제주도서산간지역이라면_결제시도할_수_없다**
            - **배송지를_수정할_수_있다**

                ```jsx
                주문전
                자기주문
                ```

            - **배송지를_수정하면_관련_상품조합들의_배송비가_계산된다**
            - **제주도서산간지역이라면_우편번호에_따라_설정된_배송비가_추가된다**
- **PresetProduct 출고**
    - state
        - BEFORE_PAYMENT
        - READY
        - ONGOING_DELIVERY
        - DELIVERED
        - CONFIRMED
        - CANCEL
        - ONGOING_REFUND
        - FINISH_REFUND
        - DENY_REFUND
    - preset_id
    - **package_id nullable**
    - **product_id nullable**
    - **option_id nullable**
    - coupon_id
        - nullable
    - **delivery_company_id nullable**
    - **아래 애들 다 nullable 처리**
    - **package_count nullable 패키지회차**
    - **package_price nullable 패키지가격**
    - **package_will_deliveried_at nullable 도착예정일**
    - **package_setting_active nullable 구독활성여부 (1회성인지 구독결제인지 확인용)**
    - product_title 상품명
    - product_price 상품판매가
    - product_price_origin 상품정가
    - count 개수
    - option_title 옵션제목
    - option_price 옵션가걱
    - option_type 옵션유형
    - delivery_name nullable 수취인 이름
    - delivery_contact nullable 수취인 연락처
    - delivery_address nullable 주소
    - delivery_address_detail nullable 상세주소
    - delivery_address_zipcode  nullable 우편번호
    - delivery_requirement nullable 배송요청사항
    - delivery_number nullable 운송장번호
    - **[삭제] delivery_company nullable 택배사**
    - delivery_at nullable 배송완료일자
    - price_coupon default 0 쿠폰적용금액
    - point default 0 배분된 적립금
    - reason_request_refund nullable 취소요청사유
    - reason_deny_refund nullable 취소요청 반려사유
        - attributes
            - coupons
            - **materials**
            - **format_materials (유럽상추 레드 100g * 2, 적양배추 400g * 2)**
            - **canLatePackage 미루기 가능한 패키지**
            - **canFastPackage 당기기 가능한 패키지**
            - **can_confirm 구매확정 가능여부**
                - **내 주문**
                - **배송완료상태**
            - **can_review  리뷰가능여부**
            - **can_cancel 주문취소가능여부**
                - **출고준비전까지는 취소가능**
                - **내 주문이여야만 취소가능**
        - testcase
            - 쿠폰을_적용할_수_있다
            - 자신의_쿠폰이고_사용한적_없는_쿠폰만_사용할_수_있다
            - 쿠폰사용불가_상품에는_쿠폰을_적용할_수_없다
            - 쿠폰을_적용하면_상품조합의_비용과_출고의_쿠폰적용금액이_갱신된다
            - **리뷰작성_생성_가능한_목록을_조회할_수_있다**
            - **채소이야기_생성_가능한_목록을_조회할_수_있다**
            - **주문취소를_할_수_있다**
            - **주문에서_취소가능여부를_조회할_수_있다**
                - **자신의 주문이 아닌 경우**
                - **결제대기 또는 배송준비 상태일때만 가능**
            - **주문이_취소상태가_되면_출고내역이_취소상태가_된다**
            - **주문의_취소상태가_되면_사용한_쿠폰과_포인트는_구성상품에_맞게_차감된다**

                ```jsx
                -> 
                - **주문이_취소상태가_되면_쿠폰은_미사용처리된다**
                    - **user_id가 있는 경우에만**
                    - **쿠폰사용기록이 생성되어야함**
                    - **package에 coupon_**
                - **주문이_취소상태가_되면_사용한_포인트는_반환된다**
                    - **user_id가 있는 경우에만**
                    - **포인트기록이 생성되어야함**
                ```

            - **구매확정을_할_수_있다**

                ```
                DELIVERIED 상태일때만 가능
                ```

            - **배송상태갱신을_실행하면_배송상태가_수정된다**

                ```
                API 참고해서 추가설계필요
                ```

              ![image.png](attachment:59fe3714-3890-4ff9-8bc0-52ce46342368:image.png)


- 패키지 설계

    ```jsx
    # 패키지
    1회차
    2회차
    3회차
    4회차
    
    # 현재 회차
    1회차
    
    # 절차
    - 사용자가_구독신청을_하면_출고가_생성된다
    	- 현재_구매가능한_회차가_대상_회차로_기록된다
    	- 패키지설정의_꾸러미유형에_맞게_출고에_꾸러미품목이_배정된다
    	- 꾸러미품목은_수정할_수_있다
    		- 꾸러미품목은_해당_회차의_상품구성_시간에만_수정할_수_있다
    		- 꾸러미품목은_해당_회차의_꾸러미유형에_맞는_품목이거나_선택가능품목중에서만_수정할_수_있다
    		- 꾸러미품목의_금액_총합은_패키지설정의_꾸러미유형의_해당_유형_금액이_최소금액을_맞춰야한다
    		- 꾸러미품목의_총합이_상품금액이_된다 (품목개수, 품목가격을 가지고 계산)
    	- 일회성이라면_1회구매로_생성된다
    	- 일회성이라면_1회구매로_생성된다
    	- 일회성_구매라면
    	- 일회성이_아니라면
    		1.2.1. 구독으로_생성된다
    			1.2.2. 현재_구매가능한_회차가_대상_회차로_기록된다
    			1.2.3. 패키지설정의_배송주기를_고려해_다음예정회차가_기록된다
    			1.2.4. 
    		1.2.2. 구독으로_생성되면_패키지_설정의_배송주기를_고려해_다음예정회차가_기록된다
    		1.2.3. 
    ```


---

### 관리자

- User
    - 마케팅수신여부별_목록을_조회할_수_있다
    - 구독상태별_목록을_조회할_수_있다
        - 구독중
        - 구독안함
    - 엑셀_다운을_할_수_있다 (전체, 선택)